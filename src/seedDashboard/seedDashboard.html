<template>
  <div class="page animated-page au-animate seedDashboardContainer">
    <div show.to-view="!loading" class="seedDashboard">
      <div class="leftColumn">
        <div class="intro">
          <div class="leftSection">
            <div class="header">
              <div class="title heading heading2">PrimeDAO</div>
              <div class="timeLeft">
                <time-left seed.to-view="seed"></time-left>
              </div>
            </div>
            <div class="description subtext">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut
              pretium pretium tempor. Ut eget imperdiet neque. In volutpat
              ante semper diam molestie, et aliquam.</div>
          </div>
          <div class="rightSection">
            <template if.to-view="seed.isActive">
              <div class="label">TIME LEFT</div>
              <div class="timeLeft">${seed.endsInMilliseconds | timespan:"minutes"}</div>
            </template>
          </div>
        </div>
        <!--
          ================ 
          Section One
          ================ 
        -->
        <div if.to-view="!connected" class="secton section1">
          <div class="description">Check eligibility</div>
          <div class="help">
            <question-mark text="Check eligibility"></question-mark>
          </div>
          <div class="subdescription subtext">Connect your wallet to contribute and claim rewards.</div>
          <div class="doit"><button class="button1" click.delegate="connect()">CONNECT</button></div>
        </div>
        <!--
          ================ 
          Section Two
          ================ 
        -->
        <div if.to-view="connected && seed.userIsWhitelisted" class="secton section2">
          <div class="description">Contribute</div>
          <div class="help">
            <question-mark text="Contribute"></question-mark>
          </div>
          <div class="form">
            <div class="input">
              <div class="fundingInput">
                <numeric-input disabled.to-view="!seed.isActive" value.bind="fundingTokenToPay" placeholder="0.0"></numeric-input>
                <div if.to-view="seed.isActive" class="maxButton">
                  <a href="#" click.delegate="handleMaxBuy()">MAX</a>
                </div>
              </div>
            </div>
            <div class="units1">
              <div class="container">
                <div class="token">${seed.fundingTokenInfo.symbol}</div>
                <div class="subsection subtext">Balance: <tokenbalance
                    token-address.to-view="seed.fundingTokenAddress">
                  </tokenbalance>
                </div>
                <div if.to-view="userCanPay && lockRequired" class="unlockButton">
                  <a href="#" click.delegate="unlockFundingTokens()">UNLOCK</a>
                </div>
              </div>
            </div>
            <div class="equals">=</div>
            <div class="output">
              <formatted-number
                value.to-view="seedTokenReward"
                average="true"></formatted-number>
            </div>
            <div class="units2">
              <div class="container">
                <div class="token">${seed.seedTokenInfo.symbol}</div>
              </div>
            </div>
            <div class="vestedMessage subtext">Tokens will vest for ${seed.vestingDuration} days with a cliff of ${seed.vestingCliff} days</div>
          </div>
          <div class="doit"><button class="submitButton button1" click.delegate="buy()">SUBMIT</button></div>
        </div>
        <!--
          ================ 
          Section Three
          ================ 
        -->
        <div if.to-view="connected && seed.userIsWhitelisted" class="secton section3">
          <div class="description">Claim tokens</div>
          <div class="help">
            <question-mark text="Claim tokens"></question-mark>
          </div>
          <div class="form">
            <div class="input">
              <div class="seedRequest">
                <numeric-input
                  disabled.to-view="!userCanClaim"
                  value.bind="seedTokenToReceive"
                  placeholder="0.0"></numeric-input>
                <div class="maxButton" if.to-view="userCanClaim">
                  <a href="#" click.delegate="handleMaxClaim()">MAX</a>
                </div>
              </div>
            </div>
            <div class="units1">
              <div class="container">
                <div class="token">${seed.seedTokenInfo.symbol}</div>
                <div class="subsection subtext">Claimable: <formatted-number
                    value.to-view="seed.userClaimableAmount | ethwei"
                    average="false"
                    thousands-separated></formatted-number>
                </div>
              </div>
            </div>
            <div class="equals">&nbsp;</div>
            <div class="output">1</div>
            <div class="units2">
              <div class="container">
                <div class="token">${seed.seedTokenInfo.symbol}</div>
                <div class="subsection subtext">Pending</div>
              </div>
            </div>
            <div
              if.to-view="!seed.isActive"
              class="vestedMessage subtext">Claiming will open whenever the MAX is reached, or in ${seed.endsInMilliseconds | timespan:"seconds":true}${seed.minimumReached ? '' : ', if by then the target has been reached'}</div>
          </div>
          <div class="doit"><button class="submitButton button1 ${userCanClaim ? '' : 'hide'}" click.delegate="claim()">SUBMIT</button></div>
        </div>
        <div class="notWhitelisted" if.to-view="connected && !seed.userIsWhitelisted">
          Sorry, this Seed has a whitelist and your account has not been whitelisted. So using this account, you will not be able to participate.
        </div>
      </div>
      <div class="rightColumn">
        <div class="section topSection">
          <div class="tokenId">
            <div class="icon"><img src.to-view="seed.seedTokenInfo.icon"></img></div>
            <div class="name">${seed.seedTokenInfo.name}</div>
            <div class="symbol">(${seed.seedTokenInfo.symbol})</div>
          </div>
          <div ref="progressBar" class="progressBar">
            <div ref="bar" class="bar ${fractionComplete >= 1 ? 'complete' : ''}">&nbsp;</div>
          </div>
          <div class="raised">
            <div class="amount">$<formatted-number
                value.to-view="amountRaised | ethwei"
                average="false"
                thousands-separated></formatted-number>
            </div>
            <div class="denomination">USD raised</div>
            <!-- <div if.to-view="fractionComplete < 1" class="perc"> -->
            <div class="perc">
              <formatted-number
                value.to-view="fractionComplete * 100"
                average="false"
                mantissa="2"></formatted-number>%
            </div>
            <!-- <div else class="perc filled">Filled</div> -->
          </div>
        </div>
        <div class="section middleSection">
          <div class="label targetLabel">TARGET</div>
          <div class="value target">
            <formatted-number value.to-view="seed.target | ethwei" mantissa="2"></formatted-number>
          </div>
          <div class="label maxLabel">MAX</div>
          <div class="value max">
            <formatted-number value.to-view="seed.cap | ethwei" mantissa="2"></formatted-number>
          </div>
          <div class="label valuationLabel">VALUATION</div>
          <div class="value valuation">$ <formatted-number
              if.to-view="seed.valuation"
              value.to-view="seed.valuation"
              average="false"
              thousands-separated></formatted-number>
            <span else>N/A</span>
          </div>
          <div class="label tokensleftLabel">TOKENS LEFT</div>
          <div class="value tokensleft">
            <formatted-number if.to-view="seedTokensLeft" value.to-view="seedTokensLeft"></formatted-number><span else>N/A</span>%
          </div>
          <div class="tokenpriceLabel">
            <token-pair token1.to-view="seed.seedTokenInfo.icon" token2.to-view="seed.fundingTokenInfo.icon"></token-pair>
          </div>
          <div class="value tokenprice">1 <div class="symbol">${seed.seedTokenInfo.symbol}</div> = ${seed.fundingTokensPerSeedToken} <div class="symbol">${seed.fundingTokenInfo.symbol}</div>
          </div>
        </div>
        <div class="section bottomSection">
          <div class="title  heading heading3">About Kolektivo</div>
          <div class="body subtext">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</div>
          <div if.to-view="links.length" class="links">
            <a repeat.for="link of links" href.to-view="link.url" target="_blank" rel="noopener noreferrer">
              <div class="icon ${iconClassForLinkType(link.name)}"></div>
              <div class="name">${link.name}</div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>
